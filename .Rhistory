x = "Ano",
y = "Quantidade",
fill = "Série"
) +
theme_minimal(base_size = 12) +
theme(
panel.grid.minor = element_blank(),
legend.position = "bottom"
)
pd <- position_dodge(width = 0.85)
ggplot(fig_A_total_agencias, aes(x = factor(ano_arq), y = valor, fill = serie)) +
geom_col(position = pd, width = 0.8) +
geom_text(aes(label = scales::number(valor, big.mark = ".", decimal.mark = ",")),
position = position_dodge(width = 0.85),
vjust = -0.3, size = 3.5, color = "black") +
scale_fill_manual(values = c("#1b9e77","#7570b3","#d95f02","#66a61e"),
labels = rotulos) +
scale_y_continuous(labels = label_number(big.mark = ".", decimal.mark = ","),
expand = expansion(mult = c(0.02, 0.08))) +
labs(
title = "Comparativo por ano selecionado",
x = "Ano",
y = "Quantidade",
fill = "Série"
) +
theme_minimal(base_size = 12) +
theme(
panel.grid.minor = element_blank(),
legend.position = "bottom"
)
ggplot(fig_A_total_agencias, aes(x = factor(ano_arq), y = valor, fill = serie)) +
geom_col(position = pd, width = 0.8) +
geom_text(aes(label = scales::number(valor, big.mark = ".", decimal.mark = ",")),
position = position_dodge(width = 0.85),
vjust = -0.3, size = 3.5, color = "black") +
scale_fill_manual(values = c("#1b9e77","#7570b3","#d95f02","#66a61e"),
labels = rotulos) +
scale_y_continuous(labels = label_number(big.mark = ".", decimal.mark = ","),
expand = expansion(mult = c(0.02, 0.08))) +
labs(
title = "Total number of people, positions, officers, and officers appointed at all the Regulatory Agencies",
x = "Ano",
y = "Quantidade",
fill = "Série"
) +
theme_minimal(base_size = 12) +
theme(
panel.grid.minor = element_blank(),
legend.position = "bottom"
)
# Rótulos legíveis
rotulos <- c(
"total_agencias" = "RAs (total)",
"total_agencias_total_cargos" = "RAs (appointed positions - all levels)",
"total_militares_ars" = "RAs (total officers)",
"total_militares_ars_com_cargo" = "RAs (officers appointed)"
)
ggplot(fig_A_total_agencias, aes(x = factor(ano_arq), y = valor, fill = serie)) +
geom_col(position = pd, width = 0.8) +
geom_text(aes(label = scales::number(valor, big.mark = ".", decimal.mark = ",")),
position = position_dodge(width = 0.85),
vjust = -0.3, size = 3.5, color = "black") +
scale_fill_manual(values = c("#1b9e77","#7570b3","#d95f02","#66a61e"),
labels = rotulos) +
scale_y_continuous(labels = label_number(big.mark = ".", decimal.mark = ","),
expand = expansion(mult = c(0.02, 0.08))) +
labs(
title = "Total number of people, positions, officers, and officers appointed at all the Regulatory Agencies",
x = "Year",
y = "Amount",
fill = ""
) +
theme_minimal(base_size = 12) +
theme(
panel.grid.minor = element_blank(),
legend.position = "bottom"
)
plot_long
ggplot(plot_long, aes(x = ano_arq, y = valor, color = agencia_label, group = agencia_label)) +
geom_line(size = 0.9, alpha = 0.9) +
geom_point(size = 1.8) +
scale_x_continuous(breaks = sort(unique(plot_long$ano_arq))) +
scale_y_continuous(labels = label_number(big.mark = ".", decimal.mark = ",")) +
labs(
title = "Totais anuais por agência e grupo",
x = "Ano",
y = "Quantidade",
color = "Agência"
) +
facet_wrap(~ grupo, ncol = 1, scales = "free_y",
labeller = as_labeller(c(base = "ARs (base)",
cargos = "ARs (cargos)",
alto_escalao = "ARs (alto escalão)"))) +
theme_minimal(base_size = 12) +
theme(
panel.grid.minor = element_blank(),
legend.position = "bottom",
legend.key.width = unit(16, "pt")
)
# Definir vetores por faceta
grp_base <- c("militares_anac","militares_aneel","militares_anatel","militares_antaq",
"militares_antt","militares_anvs","militares_ancine","militares_anp",
"militares_ans","militares_anm","militares_ana")
grp_cargos <- paste0(grp_base, "_cargos")
grp_alto   <- paste0(grp_base, "_alto_escalao")
vars_all <- c(grp_base, grp_cargos, grp_alto)
stopifnot(all(c("ano_arq", vars_all) %in% names(df_ano_out)))
# Agregar por ano, se necessário
base_df <- df_ano_out %>%
group_by(ano_arq) %>%
summarise(across(all_of(vars_all), ~ sum(.x, na.rm = TRUE)), .groups = "drop")
# Long + coluna do grupo
plot_long <- base_df %>%
pivot_longer(cols = all_of(vars_all), names_to = "agencia", values_to = "valor") %>%
mutate(
grupo = case_when(
str_detect(agencia, "_alto_escalao$") ~ "alto_escalao",
str_detect(agencia, "_cargos$") ~ "cargos",
TRUE ~ "base"
),
agencia_label = str_replace(agencia, "militares_", "") |>
str_replace("_cargos$", "") |>
str_replace("_alto_escalao$", "") |>
toupper()
)
ggplot(plot_long, aes(x = ano_arq, y = valor, color = agencia_label, group = agencia_label)) +
geom_line(size = 0.9, alpha = 0.9) +
geom_point(size = 1.8) +
scale_x_continuous(breaks = sort(unique(plot_long$ano_arq))) +
scale_y_continuous(labels = label_number(big.mark = ".", decimal.mark = ",")) +
labs(
title = "Totais anuais por agência e grupo",
x = "Ano",
y = "Quantidade",
color = "Agência"
) +
facet_wrap(~ grupo, ncol = 1, scales = "free_y",
labeller = as_labeller(c(base = "ARs (base)",
cargos = "ARs (cargos)",
alto_escalao = "ARs (alto escalão)"))) +
theme_minimal(base_size = 12) +
theme(
panel.grid.minor = element_blank(),
legend.position = "bottom",
legend.key.width = unit(16, "pt")
)
fig_A_facetas
# Agregar por ano, se necessário
base_df <- df_ano_out %>%
group_by(ano_arq) %>%
summarise(across(all_of(vars_all), ~ sum(.x, na.rm = TRUE)), .groups = "drop")
# Long + coluna do grupo
fig_A_facetas <- base_df %>%
pivot_longer(cols = all_of(vars_all), names_to = "agencia", values_to = "valor") %>%
mutate(
grupo = case_when(
str_detect(agencia, "_alto_escalao$") ~ "alto_escalao",
str_detect(agencia, "_cargos$") ~ "cargos",
TRUE ~ "base"
),
agencia_label = str_replace(agencia, "militares_", "") |>
str_replace("_cargos$", "") |>
str_replace("_alto_escalao$", "") |>
toupper()
)
ggplot(fig_A_facetas, aes(x = ano_arq, y = valor, color = agencia_label, group = agencia_label)) +
geom_line(size = 0.9, alpha = 0.9) +
geom_point(size = 1.8) +
scale_x_continuous(breaks = sort(unique(plot_long$ano_arq))) +
scale_y_continuous(labels = label_number(big.mark = ".", decimal.mark = ",")) +
labs(
title = "Totais anuais por agência e grupo",
x = "Ano",
y = "Quantidade",
color = "Agência"
) +
facet_wrap(~ grupo, ncol = 1, scales = "free_y",
labeller = as_labeller(c(base = "ARs (base)",
cargos = "ARs (cargos)",
alto_escalao = "ARs (alto escalão)"))) +
theme_minimal(base_size = 12) +
theme(
panel.grid.minor = element_blank(),
legend.position = "bottom",
legend.key.width = unit(16, "pt")
)
fig_A_facetas
ggplot(fig_A_facetas, aes(x = ano_arq, y = valor, color = agencia_label, group = agencia_label)) +
geom_line(size = 0.9, alpha = 0.9) +
geom_point(size = 1.8) +
scale_x_continuous(breaks = sort(unique(plot_long$ano_arq))) +
scale_y_continuous(labels = label_number(big.mark = ".", decimal.mark = ",")) +
labs(
title = "Totais anuais por agência e grupo",
x = "Ano",
y = "Quantidade",
color = "Agência"
) +
facet_wrap(~ grupo, ncol = 1, scales = "free_y",
labeller = as_labeller(c(base = "ARs (base)",
cargos = "ARs (cargos)",
alto_escalao = "ARs (alto escalão)"))) +
theme_minimal(base_size = 12) +
theme(
panel.grid.minor = element_blank(),
legend.position = "bottom",
legend.key.width = unit(16, "pt")
)
ggplot(fig_A_facetas, aes(x = ano_arq, y = valor, color = agencia_label, group = agencia_label)) +
geom_line(size = 0.9, alpha = 0.9) +
geom_point(size = 1.8) +
scale_x_continuous(breaks = sort(unique(plot_long$ano_arq))) +
scale_y_continuous(labels = label_number(big.mark = ".", decimal.mark = ",")) +
labs(
title = "Totais anuais por agência e grupo",
x = "Year",
y = "Quantidade",
color = "Agência"
) +
facet_wrap(~ grupo, ncol = 1, scales = "free_y",
labeller = as_labeller(c(base = "ARs (base)",
cargos = "ARs (cargos)",
alto_escalao = "ARs (alto escalão)"))) +
theme_minimal(base_size = 12) +
theme(
panel.grid.minor = element_blank(),
legend.position = "bottom",
legend.key.width = unit(16, "pt")
)
ggsave("figures/fig_A_facetas.pdf", fig_A_facetas,
width = 6.5, height = 5, units = "in")
fig_A_facetas
# Long + coluna do grupo
facetas <- base_df %>%
pivot_longer(cols = all_of(vars_all), names_to = "agencia", values_to = "valor") %>%
mutate(
grupo = case_when(
str_detect(agencia, "_alto_escalao$") ~ "alto_escalao",
str_detect(agencia, "_cargos$") ~ "cargos",
TRUE ~ "base"
),
agencia_label = str_replace(agencia, "militares_", "") |>
str_replace("_cargos$", "") |>
str_replace("_alto_escalao$", "") |>
toupper()
)
fig_A_facetas <- ggplot(facetas, aes(x = ano_arq, y = valor, color = agencia_label, group = agencia_label)) +
geom_line(size = 0.9, alpha = 0.9) +
geom_point(size = 1.8) +
scale_x_continuous(breaks = sort(unique(plot_long$ano_arq))) +
scale_y_continuous(labels = label_number(big.mark = ".", decimal.mark = ",")) +
labs(
title = "Totais anuais por agência e grupo",
x = "Year",
y = "Quantidade",
color = "Agência"
) +
facet_wrap(~ grupo, ncol = 1, scales = "free_y",
labeller = as_labeller(c(base = "ARs (base)",
cargos = "ARs (cargos)",
alto_escalao = "ARs (alto escalão)"))) +
theme_minimal(base_size = 12) +
theme(
panel.grid.minor = element_blank(),
legend.position = "bottom",
legend.key.width = unit(16, "pt")
)
fig_A_facetas
ggsave("figures/fig_A_facetas.pdf", fig_A_facetas,
width = 6.5, height = 5, units = "in")
fig_A2_facetas <- ggplot(plot_long, aes(x = ano_arq, y = valor, color = dim)) +
geom_line(size = 1) +
geom_point(size = 1.8) +
scale_color_manual(values = c("All officers" = "#1b9e77", "Appointees" = "#7570b3", "Top-level" = "#d95f02")) +
scale_x_continuous(breaks = sort(unique(plot_long$ano_arq))) +
scale_y_continuous(labels = label_number(big.mark = ".", decimal.mark = ",")) +
labs(
title = "Total officers in Regulatory Agencies (2013-2023)",
x = "Year",
y = "Amount",
color = ""
) +
facet_wrap(~ ar, ncol = 3, scales = "free_y") +
theme_minimal(base_size = 12) +
theme(
panel.grid.minor = element_blank(),
legend.position = "bottom"
)
fig_A2_facetas
# Lista de ARs
ars <- c("anac","aneel","anatel","antaq","antt","anvs","ancine","anp","ans","anm","ana")
# Construir nomes de colunas para cada dimensão
vars_base   <- paste0("militares_", ars)
vars_cargos <- paste0("militares_", ars, "_cargos")
vars_alto   <- paste0("militares_", ars, "_alto_escalao")
vars_all <- c(vars_base, vars_cargos, vars_alto)
# Agregar por ano (se necessário)
base_df <- df_ano_out %>%
group_by(ano_arq) %>%
summarise(across(all_of(vars_all), ~ sum(.x, na.rm = TRUE)), .groups = "drop")
# Converter para longo e separar AR e dimensão
plot_long <- base_df %>%
pivot_longer(cols = all_of(vars_all), names_to = "serie", values_to = "valor") %>%
mutate(
# Extrair a AR do nome: "militares_anac(_...)" -> "anac"
ar  = str_remove(serie, "^militares_") %>%
str_remove("_cargos$") %>%
str_remove("_alto_escalao$") %>%
toupper(),
dim = case_when(
str_detect(serie, "_alto_escalao$") ~ "Top-level",
str_detect(serie, "_cargos$")       ~ "Appointees",
TRUE                                ~ "All officers"
)
) %>%
# Opcional: ordenar facetas por ordem desejada
mutate(ar = factor(ar, levels = toupper(ars)))
fig_A2_facetas <- ggplot(plot_long, aes(x = ano_arq, y = valor, color = dim)) +
geom_line(size = 1) +
geom_point(size = 1.8) +
scale_color_manual(values = c("All officers" = "#1b9e77", "Appointees" = "#7570b3", "Top-level" = "#d95f02")) +
scale_x_continuous(breaks = sort(unique(plot_long$ano_arq))) +
scale_y_continuous(labels = label_number(big.mark = ".", decimal.mark = ",")) +
labs(
title = "Total officers in Regulatory Agencies (2013-2023)",
x = "Year",
y = "Amount",
color = ""
) +
facet_wrap(~ ar, ncol = 3, scales = "free_y") +
theme_minimal(base_size = 12) +
theme(
panel.grid.minor = element_blank(),
legend.position = "bottom"
)
fig_A2_facetas
ggsave("figures/fig_A2_facetas.pdf", fig_A2_facetas,
width = 6.5, height = 5, units = "in")
fig_A2_facetas
# Seleção e reshape
fig_A3_total_agencias <- df_ano_out %>%
filter(ano_arq %in% anos) %>%
select(ano_arq, all_of(vars)) %>%
pivot_longer(cols = all_of(vars), names_to = "serie", values_to = "valor")
# Rótulos legíveis
rotulos <- c(
"total_agencias" = "RAs (total)",
"total_agencias_total_cargos" = "RAs (appointed positions - all levels)",
"total_militares_ars" = "RAs (total officers)",
"total_militares_ars_com_cargo" = "RAs (officers appointed)"
)
pd <- position_dodge(width = 0.85)
ggplot(fig_A3_total_agencias, aes(x = factor(ano_arq), y = valor, fill = serie)) +
geom_col(position = pd, width = 0.8) +
geom_text(aes(label = scales::number(valor, big.mark = ".", decimal.mark = ",")),
position = position_dodge(width = 0.85),
vjust = -0.3, size = 3.5, color = "black") +
scale_fill_manual(values = c("#1b9e77","#7570b3","#d95f02","#66a61e"),
labels = rotulos) +
scale_y_continuous(labels = label_number(big.mark = ".", decimal.mark = ","),
expand = expansion(mult = c(0.02, 0.08))) +
labs(
title = "Total number of people, positions, officers, and officers appointed at all the Regulatory Agencies",
x = "Year",
y = "Amount",
fill = ""
) +
theme_minimal(base_size = 12) +
theme(
panel.grid.minor = element_blank(),
legend.position = "bottom"
)
ggsave("figures/fig_A3_total_agencias.pdf", fig_A3_total_agencias,
width = 8.5, height = 5, units = "in")
ggsave("figures/fig_A3_total_agencias.pdf", fig_A3_total_agencias,
width = 6.5, height = 5, units = "in")
fig_A3_total_agencias
# Seleção e reshape
total_agencias <- df_ano_out %>%
filter(ano_arq %in% anos) %>%
select(ano_arq, all_of(vars)) %>%
pivot_longer(cols = all_of(vars), names_to = "serie", values_to = "valor")
fig_A3_total_agencias <- ggplot(total_agencias, aes(x = factor(ano_arq), y = valor, fill = serie)) +
geom_col(position = pd, width = 0.8) +
geom_text(aes(label = scales::number(valor, big.mark = ".", decimal.mark = ",")),
position = position_dodge(width = 0.85),
vjust = -0.3, size = 3.5, color = "black") +
scale_fill_manual(values = c("#1b9e77","#7570b3","#d95f02","#66a61e"),
labels = rotulos) +
scale_y_continuous(labels = label_number(big.mark = ".", decimal.mark = ","),
expand = expansion(mult = c(0.02, 0.08))) +
labs(
title = "Total number of people, positions, officers, and officers appointed at all the Regulatory Agencies",
x = "Year",
y = "Amount",
fill = ""
) +
theme_minimal(base_size = 12) +
theme(
panel.grid.minor = element_blank(),
legend.position = "bottom"
)
fig_A3_total_agencias
ggsave("figures/fig_A3_total_agencias.pdf", fig_A3_total_agencias,
width = 6.5, height = 5, units = "in")
ggsave("figures/fig_A3_total_agencias.pdf", fig_A3_total_agencias,
width = 8.5, height = 5, units = "in")
fig_A3_total_agencias <- ggplot(total_agencias, aes(x = factor(ano_arq), y = valor, fill = serie)) +
geom_col(position = pd, width = 0.8) +
geom_text(aes(label = scales::number(valor, big.mark = ".", decimal.mark = ",")),
position = position_dodge(width = 0.85),
vjust = -0.3, size = 3.5, color = "black") +
scale_fill_manual(values = c("#1b9e77","#7570b3","#d95f02","#66a61e"),
labels = rotulos) +
scale_y_continuous(labels = label_number(big.mark = ".", decimal.mark = ","),
expand = expansion(mult = c(0.02, 0.08))) +
labs(
title = "Total number of people, positions, officers, and officers appointed at all the Regulatory Agencies",
x = "Year",
y = "Amount",
fill = ""
) +
theme_minimal(base_size = 10) +
theme(
panel.grid.minor = element_blank(),
legend.position = "bottom"
)
fig_A3_total_agencias
ggsave("figures/fig_A3_total_agencias.pdf", fig_A3_total_agencias,
width = 8.5, height = 5, units = "in")
fig_A3_total_agencias <- ggplot(total_agencias, aes(x = factor(ano_arq), y = valor, fill = serie)) +
geom_col(position = pd, width = 0.8) +
geom_text(aes(label = scales::number(valor, big.mark = ".", decimal.mark = ",")),
position = position_dodge(width = 0.85),
vjust = -0.3, size = 3.5, color = "black") +
scale_fill_manual(values = c("#1b9e77","#7570b3","#d95f02","#66a61e"),
labels = rotulos) +
scale_y_continuous(labels = label_number(big.mark = ".", decimal.mark = ","),
expand = expansion(mult = c(0.02, 0.08))) +
labs(
title = "Total number of people, positions, officers, and officers appointed at all the Regulatory Agencies",
x = "Year",
y = "Amount",
fill = ""
) +
theme_minimal(base_size = 9) +
theme(
panel.grid.minor = element_blank(),
legend.position = "bottom"
)
fig_A3_total_agencias
ggsave("figures/fig_A3_total_agencias.pdf", fig_A3_total_agencias,
width = 8.5, height = 5, units = "in")
fig_A2_facetas <- ggplot(plot_long, aes(x = ano_arq, y = valor, color = dim)) +
geom_line(size = 1) +
geom_point(size = 1.8) +
scale_color_manual(values = c("All officers" = "#1b9e77", "Appointees" = "#7570b3", "Top-level" = "#d95f02")) +
scale_x_continuous(breaks = sort(unique(plot_long$ano_arq))) +
scale_y_continuous(labels = label_number(big.mark = ".", decimal.mark = ",")) +
labs(
title = "Total officers in Regulatory Agencies (2013-2023)",
x = "Year",
y = "Amount",
color = ""
) +
facet_wrap(~ ar, ncol = 3, scales = "free_y") +
theme_minimal(base_size = 9) +
theme(
panel.grid.minor = element_blank(),
legend.position = "bottom"
)
fig_A2_facetas
ggsave("figures/fig_A2_facetas.pdf", fig_A2_facetas,
width = 8.5, height = 5, units = "in")
fig_A2_facetas <- ggplot(plot_long, aes(x = ano_arq, y = valor, color = dim)) +
geom_line(size = 0.5) +
geom_point(size = 1.5) +
scale_color_manual(values = c("All officers" = "#1b9e77", "Appointees" = "#7570b3", "Top-level" = "#d95f02")) +
scale_x_continuous(breaks = sort(unique(plot_long$ano_arq))) +
scale_y_continuous(labels = label_number(big.mark = ".", decimal.mark = ",")) +
labs(
title = "Total officers in Regulatory Agencies (2013-2023)",
x = "Year",
y = "Amount",
color = ""
) +
facet_wrap(~ ar, ncol = 3, scales = "free_y") +
theme_minimal(base_size = 9) +
theme(
panel.grid.minor = element_blank(),
legend.position = "bottom"
)
fig_A2_facetas
fig_A2_facetas <- ggplot(plot_long, aes(x = ano_arq, y = valor, color = dim)) +
geom_line(size = 0.5) +
geom_point(size = 1.5) +
scale_color_manual(values = c("All officers" = "#1b9e77", "Appointees" = "#7570b3", "Top-level" = "#d95f02")) +
scale_x_continuous(breaks = sort(unique(plot_long$ano_arq))) +
scale_y_continuous(labels = label_number(big.mark = ".", decimal.mark = ",")) +
labs(
title = "Total officers in Regulatory Agencies (2013-2023)",
x = "Year",
y = "Amount",
color = ""
) +
facet_wrap(~ ar, ncol = 4, scales = "free_y") +
theme_minimal(base_size = 9) +
theme(
panel.grid.minor = element_blank(),
legend.position = "bottom"
)
fig_A2_facetas
